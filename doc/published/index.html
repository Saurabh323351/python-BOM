
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BOM.py 0.1 documentation</title>
    <link rel="stylesheet" href="_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body>
      <div class="header" role="banner"><h1 class="heading"><a href="#">
          <span>BOM.py 0.1 documentation</span></a></h1>
        <h2 class="heading"><span>BOM.py 0.1 documentation</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        <a class="uplink" href="#">Contents</a>
        </p>

      </div>
      <div class="content" role="main">
        
        
  <div class="section" id="welcome-to-bom-py-s-documentation">
<h1>Welcome to BOM.py’s documentation<a class="headerlink" href="#welcome-to-bom-py-s-documentation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="background">
<h2>Background<a class="headerlink" href="#background" title="Permalink to this headline">¶</a></h2>
<p>Some conventions used in this module are based on a few of the concepts from the
book <em>Engineering Documentation Control Handbook</em>, 4th Ed. by Frank B. Watts.
One of which is the use of a master parts list, which represents a singular
source of information for items - parts, drawings, documents, etc.
In the context of this program this is represented by an Excel file with a
special name (defaults to <code class="docutils literal notranslate"><span class="pre">Parts</span> <span class="pre">list.xlsx</span></code>). For example, parts for a
skateboard might have:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 11%" />
<col style="width: 13%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 11%" />
<col style="width: 8%" />
<col style="width: 14%" />
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>PN</p></th>
<th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Supplier</p></th>
<th class="head"><p>Supplier PN</p></th>
<th class="head"><p>Pkg QTY</p></th>
<th class="head"><p>Pkg Price</p></th>
<th class="head"><p>Item</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SK1001-01</p></td>
<td><p>Bearing</p></td>
<td><p>Wheel bearing</p></td>
<td><p>XYZ Bearing Co.</p></td>
<td><p>74295-942</p></td>
<td><p>1</p></td>
<td><p>2.99</p></td>
<td><p>part</p></td>
</tr>
<tr class="row-odd"><td><p>SK1002-01</p></td>
<td><p>Board</p></td>
<td><p>Standard type</p></td>
<td><p>Skatr Dude Inc.</p></td>
<td><p>BRX-02</p></td>
<td><p>1</p></td>
<td><p>15.99</p></td>
<td><p>part</p></td>
</tr>
<tr class="row-even"><td><p>SK1003-01</p></td>
<td><p>Truck half</p></td>
<td><p>Truck fixed</p></td>
<td><p>Skatr Dude Inc.</p></td>
<td><p>TR1-A</p></td>
<td><p>1</p></td>
<td><p>9.87</p></td>
<td><p>part</p></td>
</tr>
<tr class="row-odd"><td><p>SK1004-01</p></td>
<td><p>Truck half</p></td>
<td><p>Truck movable</p></td>
<td><p>Skatr Dude Inc.</p></td>
<td><p>TR1-B</p></td>
<td><p>1</p></td>
<td><p>12.25</p></td>
<td><p>part</p></td>
</tr>
<tr class="row-even"><td><p>SK1005-01</p></td>
<td><p>Truck screw</p></td>
<td><p>1/4-20 SHCS</p></td>
<td><p>Bolts R Us</p></td>
<td><p>92220A</p></td>
<td><p>50</p></td>
<td><p>12.86</p></td>
<td><p>part</p></td>
</tr>
<tr class="row-odd"><td><p>SK1006-01</p></td>
<td><p>Wheel</p></td>
<td><p>Hard clear urethane</p></td>
<td><p>Skatr Dude Inc.</p></td>
<td><p>WHL-PRX</p></td>
<td><p>4</p></td>
<td><p>9.87</p></td>
<td><p>part</p></td>
</tr>
<tr class="row-even"><td><p>SK1007-01</p></td>
<td><p>Nut</p></td>
<td><p>1/4-20 Hex nut</p></td>
<td><p>Bolts R Us</p></td>
<td><p>95479A</p></td>
<td><p>50</p></td>
<td><p>4.88</p></td>
<td><p>part</p></td>
</tr>
</tbody>
</table>
<p>For each assembly, all that is required is the part identification number and
its quantity which correspond to the following fields:</p>
<ul class="simple">
<li><p>PN</p></li>
<li><p>QTY</p></li>
</ul>
<p>Example:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 69%" />
<col style="width: 31%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>PN</p></th>
<th class="head"><p>QTY</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SK1003-01</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>SK1004-01</p></td>
<td><p>1</p></td>
</tr>
</tbody>
</table>
<p>Certain fields are used in calculating totals, such as in <a class="reference internal" href="#BOM.BOM.summary" title="BOM.BOM.summary"><code class="xref py py-attr docutils literal notranslate"><span class="pre">BOM.BOM.summary</span></code></a>,
which are:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 22%" />
<col style="width: 78%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Pkg</span> <span class="pre">QTY</span></code></p></td>
<td><p>The quantity of items in a specific supplier SKU (i.e. a bag
of 100 screws)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Pkg</span> <span class="pre">Price</span></code></p></td>
<td><p>The cost of a specific supplier SKU</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>Create a folder to contain your BOM files and create a parts list and any
assemblies as individual Excel files (the file name becomes the assembly item
number by default). Then, call class method <a class="reference internal" href="#BOM.BOM.from_folder" title="BOM.BOM.from_folder"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BOM.BOM.from_folder()</span></code></a>
with the path to your folder to instantiate and build BOM objects.</p>
<p>Then, call methods or properties on the root BOM returned from
<a class="reference internal" href="#BOM.BOM.from_folder" title="BOM.BOM.from_folder"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BOM.BOM.from_folder()</span></code></a> to obtain derived information:</p>
<dl class="simple">
<dt><a class="reference internal" href="#BOM.BOM.parts" title="BOM.BOM.parts"><code class="xref py py-attr docutils literal notranslate"><span class="pre">BOM.BOM.parts</span></code></a></dt><dd><p>Get a list of all direct-child parts</p>
</dd>
<dt><a class="reference internal" href="#BOM.BOM.assemblies" title="BOM.BOM.assemblies"><code class="xref py py-attr docutils literal notranslate"><span class="pre">BOM.BOM.assemblies</span></code></a></dt><dd><p>Get a list of all direct-child assemblies</p>
</dd>
<dt><a class="reference internal" href="#BOM.BOM.quantities" title="BOM.BOM.quantities"><code class="xref py py-attr docutils literal notranslate"><span class="pre">BOM.BOM.quantities</span></code></a></dt><dd><p>Get the quantity of each direct child in the BOM</p>
</dd>
<dt><a class="reference internal" href="#BOM.BOM.aggregate" title="BOM.BOM.aggregate"><code class="xref py py-attr docutils literal notranslate"><span class="pre">BOM.BOM.aggregate</span></code></a></dt><dd><p>Get the aggregated quantity of each part/assembly from the current BOM level
down</p>
</dd>
<dt><a class="reference internal" href="#BOM.BOM.summary" title="BOM.BOM.summary"><code class="xref py py-attr docutils literal notranslate"><span class="pre">BOM.BOM.summary</span></code></a></dt><dd><p>Get a summary in the form of a DataFrame containing the master parts list
with each item’s aggregated quantity and the required packages to buy if the
<code class="docutils literal notranslate"><span class="pre">Pkg</span> <span class="pre">QTY</span></code> field is not 1.</p>
</dd>
<dt><a class="reference internal" href="#BOM.BOM.tree" title="BOM.BOM.tree"><code class="xref py py-attr docutils literal notranslate"><span class="pre">BOM.BOM.tree</span></code></a></dt><dd><p>Return a string representation of the BOM tree hierarchy</p>
</dd>
</dl>
</div>
<div class="section" id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="BOM.BaseItem">
<em class="property">class </em><code class="sig-prename descclassname">BOM.</code><code class="sig-name descname">BaseItem</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">PN</span></em>, <em class="sig-param"><span class="n">parent</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">item_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#BOM.BaseItem" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for <a class="reference internal" href="#BOM.Item" title="BOM.Item"><code class="xref py py-class docutils literal notranslate"><span class="pre">Item</span></code></a> and <a class="reference internal" href="#BOM.ItemLink" title="BOM.ItemLink"><code class="xref py py-class docutils literal notranslate"><span class="pre">ItemLink</span></code></a>.</p>
</dd></dl>

<dl class="py class">
<dt id="BOM.Item">
<em class="property">class </em><code class="sig-prename descclassname">BOM.</code><code class="sig-name descname">Item</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">PN</span></em>, <em class="sig-param"><span class="n">parent</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">item_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#BOM.Item" title="Permalink to this definition">¶</a></dt>
<dd><p>A BOM item object. Represents a terminal object in a bill-of-material which
does not have children: everything except assembly such as a part, drawing,
or document. Does not have child objects and must contain a parent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>PN</strong> – Part or item number (string or number)</p></li>
<li><p><strong>parent</strong> (<a class="reference internal" href="#BOM.BOM" title="BOM.BOM"><em>BOM</em></a>) – BOM containing this item</p></li>
<li><p><strong>item_type</strong> (<em>str</em>) – A type descriptor</p></li>
<li><p><strong>kwargs</strong> – Any other fields</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="BOM.ItemLink">
<em class="property">class </em><code class="sig-prename descclassname">BOM.</code><code class="sig-name descname">ItemLink</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">target</span></em><span class="sig-paren">)</span><a class="headerlink" href="#BOM.ItemLink" title="Permalink to this definition">¶</a></dt>
<dd><p>A link to a BOM item object. Used when a BOM item is used in more than one
assembly; each ‘copy’ of the item is of this type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>target</strong> (<em>NodeMixin</em>) – The target node object (anytree)</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="BOM.BOM">
<em class="property">class </em><code class="sig-prename descclassname">BOM.</code><code class="sig-name descname">BOM</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">PN</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">parent</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">items</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">item_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">parts_db</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#BOM.BOM" title="Permalink to this definition">¶</a></dt>
<dd><p>A bill-of-material. Can be a child of another BOM or have several child
BOMs. The only required columns in the input DataFrame are a “PN” column
denoting the part name and a “QTY” column denoting the quantity of that
item.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>DataFrame</em>) – input BOM data</p></li>
<li><p><strong>PN</strong> – BOM item number</p></li>
<li><p><strong>parent</strong> (<a class="reference internal" href="#BOM.BOM" title="BOM.BOM"><em>BOM</em></a>) – another <a class="reference internal" href="#BOM.BOM" title="BOM.BOM"><code class="xref py py-class docutils literal notranslate"><span class="pre">BOM</span></code></a> object which is the
parent assembly</p></li>
<li><p><strong>items</strong> (<em>list</em>) – list of <a class="reference internal" href="#BOM.BOM" title="BOM.BOM"><code class="xref py py-class docutils literal notranslate"><span class="pre">BOM</span></code></a> or <a class="reference internal" href="#BOM.Item" title="BOM.Item"><code class="xref py py-class docutils literal notranslate"><span class="pre">Item</span></code></a>
objects included in this BOM.</p></li>
<li><p><strong>item_type</strong> (<em>str</em>) – type description of the object, one of <code class="docutils literal notranslate"><span class="pre">part</span></code>,
<code class="docutils literal notranslate"><span class="pre">assembly</span></code>, <code class="docutils literal notranslate"><span class="pre">document</span></code></p></li>
<li><p><strong>parts_db</strong> (<a class="reference internal" href="#BOM.BOM" title="BOM.BOM"><em>BOM</em></a>) – BOM object representing the master parts list</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="BOM.BOM.QTY">
<code class="sig-name descname">QTY</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">PN</span></em><span class="sig-paren">)</span><a class="headerlink" href="#BOM.BOM.QTY" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the quantity in the current BOM context for a given item
identified by its item number, <code class="docutils literal notranslate"><span class="pre">PN</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="BOM.BOM.aggregate">
<em class="property">property </em><code class="sig-name descname">aggregate</code><a class="headerlink" href="#BOM.BOM.aggregate" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> of <code class="docutils literal notranslate"><span class="pre">Item:</span> <span class="pre">count</span></code> pairs for the entire BOM
tree below the current BOM. Each item’s local QTY is multiplied by the
QTY of its containing BOM assembly.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="BOM.BOM.assemblies">
<em class="property">property </em><code class="sig-name descname">assemblies</code><a class="headerlink" href="#BOM.BOM.assemblies" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of assemblies that are direct children to this BOM</p>
</dd></dl>

<dl class="py method">
<dt id="BOM.BOM.dot">
<em class="property">property </em><code class="sig-name descname">dot</code><a class="headerlink" href="#BOM.BOM.dot" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the BOM tree structure from <a class="reference internal" href="#BOM.BOM.tree" title="BOM.BOM.tree"><code class="xref py py-attr docutils literal notranslate"><span class="pre">BOM.BOM.tree</span></code></a> in DOT graph
format (Graphiz)</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="BOM.BOM.flat">
<em class="property">property </em><code class="sig-name descname">flat</code><a class="headerlink" href="#BOM.BOM.flat" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a flattened version of the BOM with each sub-assembly contained
in it expanded.</p>
</dd></dl>

<dl class="py method">
<dt id="BOM.BOM.from_file">
<em class="property">classmethod </em><code class="sig-name descname">from_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">PN</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#BOM.BOM.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an instance of <a class="reference internal" href="#BOM.BOM" title="BOM.BOM"><code class="xref py py-class docutils literal notranslate"><span class="pre">BOM.BOM</span></code></a> based on an existing Excel
file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – Name of source Excel file</p></li>
<li><p><strong>PN</strong> – Item number, defaults to the filename with its
extension removed.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#BOM.BOM" title="BOM.BOM">BOM</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="BOM.BOM.from_folder">
<em class="property">classmethod </em><code class="sig-name descname">from_folder</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">directory</span></em>, <em class="sig-param"><span class="n">parts_file_name</span><span class="o">=</span><span class="default_value">'Parts list'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#BOM.BOM.from_folder" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a hierarchial BOM from a folder containing Excel (.xlsx) files.
The Excel file with the same name as parameter <code class="docutils literal notranslate"><span class="pre">parts_file_name</span></code> is
used as the master parts list. All others are treated as sub-assemblies.
The root BOM is discovered (there should only be one or an exception is
raised) via inter-BOM references and each non-root BOM is assigned
children and a parent. Each item not an assembly is converted to an
<a class="reference internal" href="#BOM.Item" title="BOM.Item"><code class="xref py py-class docutils literal notranslate"><span class="pre">Item</span></code></a> object.</p>
<p><strong>Note:</strong> Any files starting with an underscore are not included.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>directory</strong> (<em>str</em>) – The source directory containing BOM files.</p></li>
<li><p><strong>parts_file_name</strong> (<em>str</em>) – The name of the master parts list Excel
file.
Default is <code class="docutils literal notranslate"><span class="pre">Parts</span> <span class="pre">list.xlsx</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns a top-level BOM with all
sub-assemblies as child BOMs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#BOM.BOM" title="BOM.BOM">BOM</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="BOM.BOM.parts">
<em class="property">property </em><code class="sig-name descname">parts</code><a class="headerlink" href="#BOM.BOM.parts" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of the parts that are direct children to this BOM</p>
</dd></dl>

<dl class="py method">
<dt id="BOM.BOM.quantities">
<em class="property">property </em><code class="sig-name descname">quantities</code><a class="headerlink" href="#BOM.BOM.quantities" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dict of <code class="docutils literal notranslate"><span class="pre">Item:</span> <span class="pre">count</span></code> pairs for each direct child of this
BOM.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="BOM.BOM.summary">
<em class="property">property </em><code class="sig-name descname">summary</code><a class="headerlink" href="#BOM.BOM.summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a summary table with aggregated quantities alongside part table
information.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="BOM.BOM.tree">
<em class="property">property </em><code class="sig-name descname">tree</code><a class="headerlink" href="#BOM.BOM.tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a string representation of the complete BOM hierarchy from the
current BOM down as a tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>


      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        <a class="uplink" href="#">Contents</a>
        </p>

      </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, RSS.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.1.2.
    </div>
  </body>
</html>